<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>World Models - Research paper summaries</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./theme/catppuccin.css">
        <link rel="stylesheet" href="./theme/catppuccin-highlight.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Introduction</a></li><li class="chapter-item expanded "><a href="deep-residual-learning-for-image-recognition.html"><strong aria-hidden="true">1.</strong> Deep residual learning for image recognition</a></li><li class="chapter-item expanded "><a href="yolo.html"><strong aria-hidden="true">2.</strong> YOLO</a></li><li class="chapter-item expanded "><a href="world-models.html" class="active"><strong aria-hidden="true">3.</strong> World Models</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frapp√©</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Research paper summaries</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="paper"><a class="header" href="#paper">Paper</a></h1>
<ul>
<li><strong>Title</strong>: World Models</li>
<li><strong>Authors</strong>: David Ha, Jurgen Schmidhuber</li>
<li><strong>Link</strong>: <a href="https://arxiv.org/abs/1803.10122.pdf">https://arxiv.org/abs/1803.10122.pdf</a></li>
<li><strong>Year</strong>: 2018</li>
</ul>
<h2 id="what"><a class="header" href="#what">What</a></h2>
<ul>
<li>World model can be used to learn a compressed spatial and temporal representation of the
environment.</li>
<li>Train on &quot;hallucinated dreams&quot; and transfer the model back to the original environment.</li>
</ul>
<h2 id="how"><a class="header" href="#how">How</a></h2>
<ul>
<li>
<h3 id="overviewmotivation"><a class="header" href="#overviewmotivation">Overview/Motivation</a></h3>
<ul>
<li>We humans develop an internal model of the world.</li>
<li>We only learn concepts and relationships and use them to represent the real world.</li>
<li>Our brain learns an abstract representation of both spatial and temporal aspects of
information.</li>
<li>First train the world model in unsupervised manner and train the small controller model based
off of the world model to act in the env (Note that the world model does all the heavy
lifting and the controller just needs to act in the latent space).</li>
</ul>
</li>
</ul>
<br>
<p align="center">
<img src="images/world-models/model-working.png"
alt="Performance Degradation" width=450>
</p>
<br>
<ul>
<li>
<h3 id="agent-model"><a class="header" href="#agent-model">Agent Model</a></h3>
<ol>
<li>Visual sensory data (VAE)</li>
<li>Memory component (RNN + MDN)</li>
<li>Decision making component (Controller)</li>
</ol>
<ul>
<li>
<h4 id="vae-v"><a class="header" href="#vae-v">VAE (V)</a></h4>
<ul>
<li>The job of the VAE is to generate an efficient latent space of the original frame.<!-- TODO -->
<!-- * They mention that the image is 2D, does that mean that the model is trained on B/W images -->
<!--   instead of color images? -->
</li>
<li>Predicts <code>z(t)</code> where <code>z</code> is the latent space representation and <code>t</code> is the timestep.</li>
</ul>
</li>
<li>
<h4 id="rnn--mdnm"><a class="header" href="#rnn--mdnm">RNN + MDN(M)</a></h4>
<ul>
<li>
<p>This model compresses what happens over time. so for this purpose it predicts the future.
serves as a predictive model of the future z vectors that V is expected to produce.</p>
</li>
<li>
<p>Predicts <code>P(z(t+1) | a(t), z(t), h(t))</code>, where <code>z(t)</code> is the latent space representation
of the current observation, <code>a(t)</code> is the action taken at timestep <code>t</code>, <code>h(t)</code> is the
hidden state of the RNN at time <code>t</code>.</p>
</li>
<li>
<p>Note that it predicts <code>P(z(t+1))</code> instead of a deterministic <code>z(t+1)</code>. This is because
most environments are stochastic in nature so it outputs a Probability Density
Function(PDF).</p>
</li>
<li>
<p>They also use a temperature parameter <code>œÑ</code>(tau) to control
uncertainty/entropy/randomness(whatever you want to call it) of the hidden state while
sampling from the PDF.</p>
<br>
<p align="center">
<img src="images/world-models/rnn-arch.png"
alt="RNN architecture" width=450>
</p>
<br>
</li>
</ul>
</li>
<li>
<h4 id="controller-c"><a class="header" href="#controller-c">Controller (C)</a></h4>
<ul>
<li>Intended to be as simple and light-weight as possible, this is just a single linear layer
which maps <code>z(t)</code> and <code>h(t)</code> directly to <code>a(t)</code>. basically, <code>a(t) = W_c (z(t) + h(t)) + b_c</code>.</li>
<li>They use the Covariance-Matrix Adaptation Evolution Strategy (CMA-ES) algorithm for
optimizing the controller network C.</li>
<li>Note that using a separate and simple Contorller allows us to swap it out (for future
experimentation/work) quickly later, they suggest that it can also be swapped out for an
evolution network.</li>
</ul>
</li>
</ul>
</li>
</ul>
<br>
<p align="center">
<img src="images/world-models/model-arch.png"
alt="Model architecture" width=350>
<img src="images/world-models/pseudocode.png"
alt="Pseudocode" width=350>
</p>
<br>
<h2 id="experiments"><a class="header" href="#experiments">Experiments</a></h2>
<ul>
<li>
<h3 id="car-racing"><a class="header" href="#car-racing">Car Racing</a></h3>
<!-- Pipeline -->
<ul>
<li>They first train the VAE(V) by collecting 10k samples acting randomly in the environment
and use the usual reconstruction loss(L2) to minimize loss between the original and the
reconstructed image. (Predicts - <code>z(t)</code>)</li>
<li>They then train the RNN-MDN(M) model using the VAE(V) to predict <code>z(t+1)</code>, given the
previous hidden state of RNN.</li>
<li>They finally train the controller(C) to control 3 continuous values - steering,
acceleration and brake.</li>
<li>Train these models separately instead of training them in an end-to-end manner, which also
makes sense and is more practical.</li>
<li>The wall time for training each model was just under an hour (using 1 GPU).</li>
<li>
<h5 id="using-only-zt"><a class="header" href="#using-only-zt">Using only <code>z(t)</code></a></h5>
<ul>
<li>The basic network scores around 632 ¬± 251, on par w other leaderboard models and
adding hidden layers help the model to achieve a score of 788 ¬± 141.</li>
</ul>
</li>
<li>
<h5 id="using-zt--ht---the-full-world-model"><a class="header" href="#using-zt--ht---the-full-world-model">Using <code>z(t) + h(t)</code> - the Full World model</a></h5>
<ul>
<li>They call this the full world model, which scores around 906 ¬± 21.</li>
</ul>
</li>
</ul>
<br>
<p align="center">
<img src="images/world-models/training-pipeline.png"
alt="Model architecture" width=450>
</p>
<br>
</li>
<li>
<h3 id="vizdoom"><a class="header" href="#vizdoom">VizDoom</a></h3>
<ul>
<li>
<h4 id="learning-inside-a-dream"><a class="header" href="#learning-inside-a-dream">Learning inside a dream</a></h4>
<!-- TODO: change wordings -->
<ul>
<li>If the world model is a good representation of the original game then we can train the
controller(C) directly on the trained models instead of the actual environment and this is
exactly what they do here. They train the model directly on the learned world model
instead of interacting with the actual environment.</li>
<li>No explicit rewards are given here, but the cumulative reward is defined as the total
number of timesteps the agent manages to stay alive.</li>
<li>Training the controller(C) will be done directly in the latent space and not on raw
pixels, because there are no raw pixels here as the world model only works in the latent
space.</li>
<li>They train with a high <code>œÑ</code>(tau) and transfer the model to the actual game which
apparently performs better than the model trained with a lower <code>œÑ</code> value.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="misc"><a class="header" href="#misc">Misc</a></h3>
<ul>
<li>For more details on how the models are trained, the hyperparameters, etc, take a look at the
<strong>Appendix</strong> section in the paper.</li>
<li>I was told that the <strong>Related Works</strong> section is a gold mine, so you should probably take a look
at the papers and other articles linked there.</li>
</ul>
<!-- TODO -->
<!-- be more explicit about the training pipeline -->
<!-- explain more about dreams -->
<!-- like you update the RNN with the current z(t), and ? will the recon loss be wrt to the next frame -->

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="yolo.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="yolo.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
