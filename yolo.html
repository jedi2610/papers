<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>YOLO - Research paper summaries</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./theme/catppuccin.css">
        <link rel="stylesheet" href="./theme/catppuccin-highlight.css">
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="index.html">Introduction</a></li><li class="chapter-item expanded "><a href="deep-residual-learning-for-image-recognition.html"><strong aria-hidden="true">1.</strong> Deep residual learning for image recognition</a></li><li class="chapter-item expanded "><a href="yolo.html" class="active"><strong aria-hidden="true">2.</strong> YOLO</a></li><li class="chapter-item expanded "><a href="world-models.html"><strong aria-hidden="true">3.</strong> World Models</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="latte">Latte</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frapp√©</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Research paper summaries</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="paper"><a class="header" href="#paper">Paper</a></h1>
<ul>
<li><strong>Title</strong>: You Only Look Once: Unified, Real-Time Object Detection</li>
<li><strong>Authors</strong>: Joseph Redmon, Santosh Divvala, Ross Girshick, Ali Farhadi</li>
<li><strong>Link</strong>: <a href="https://arxiv.org/abs/1506.02640">https://arxiv.org/abs/1506.02640</a></li>
<li><strong>Code</strong>: <a href="https://github.com/pjreddie/darknet">pjreddie/darknet</a></li>
<li><strong>Year</strong>: 2015</li>
</ul>
<h2 id="what"><a class="header" href="#what">What</a></h2>
<ul>
<li>The proposed model predicts bounding boxes on images.</li>
<li>Reframes classification as a regression problem.</li>
<li>Makes localization errors but faster than R-CNN, processing images at 155 FPS.</li>
<li>End-to-end training, a single CNN simultaneously predicts the multiple bounding boxes and class
scores for those boxes.</li>
<li>Reasons globally about the image as it trains on the entire image rather than using methods like
sliding window
which trains on local regions.</li>
</ul>
<h2 id="how"><a class="header" href="#how">How</a></h2>
<ul>
<li>
<p>Model Overview</p>
<ul>
<li>Divides image in to a <code>SxS</code> grid.</li>
<li>Each grid cell predicts <code>B</code> bounding boxes.</li>
<li>Each bounding box predicts 5 values - x, y, w, h and confidence score.
<ul>
<li>(x, y) coordinates represent the center of the box relative to the grid cell.</li>
<li>w, h represent the width and height of the box relative to the whole image.</li>
<li>Confidence scores are equal to zero if there is no object in the grid cell and is
calculated as the IOU
(Intersection over Union) b/w the predicted box and the ground truth otherwise.</li>
</ul>
</li>
<li>Class probabilities to decide which of the <code>C</code> classes (<code>C</code> = number of labelled classes in
the dataset) the object belongs to.</li>
</ul>
</li>
</ul>
<br>
<p align="center">
<img src="images/yolo/overview.png" alt="Overview">
<img src="images/yolo/iou.jpeg" alt="IOU">
</p>
<br>
<ul>
<li>
<p>Model Architecture</p>
<ul>
<li>Input images are of size <code>448x448x3</code>.</li>
<li>Output are <code>S x S x (B*5 + C)</code> values.
<ul>
<li><code>S</code> is the grid size, default = 7.</li>
<li><code>B</code> is the number of predicted bounding boxes, default = 2.</li>
<li><code>C</code> is the number of labelled classes in the dataset.</li>
</ul>
</li>
<li>For each <code>B</code> bounding box it predicts 5 values: <code>x</code>, <code>y</code>, <code>w</code>, <code>h</code> and <code>confidence</code>, where:
<ul>
<li>(<code>x</code>, <code>y</code>) represent the center of the box relative to the grid cell.</li>
<li>(<code>w</code>, <code>h</code>) represent the width and height relative to the image.</li>
<li><code>confidence</code> represents the IOU b/w the predicted and ground truth box.</li>
</ul>
</li>
<li>Predicts <code>B</code> bounding boxes per grid cell and chooses the one with highest IOU during training
essentially learning to predict certain objects, aspect ratios and improve overall recall.</li>
<li>They use 24 convolutional layers followed by 2 fully connected layers with some having 1x1 convs and few having 3x3 convs.</li>
<li>The Fast YOLO uses 9 conv layers and fewer filters, all other parameters are the same for those.</li>
<li>Use linear activation function for the final layer and leaky RELUs with alpha = <code>0.1</code> for the rest.</li>
<li>Use dropout with <code>0.5</code> after the first layer to prevent co-adaptation b/w layers.</li>
<li>Use momentum of <code>0.9</code> and decay of <code>0.0005</code> - pretty standard stuff.</li>
<li>Gradually increase learning rate from 10<sup>-3</sup> to 10<sup>-2</sup> for the first epoch
and continue training with that till 75 epochs, then 10<sup>-3</sup> for next 30 epochs and
finally 10<sup>-4</sup> for the rest.</li>
<li>They found that if they started with a high learning rate then the model often diverges due to unstable gradients.</li>
</ul>
</li>
</ul>
<br>
<p align="center">
<img src="images/yolo/architecture.png" alt="Architecture">
</p>
<br>
<ul>
<li>
<p>Training</p>
<ul>
<li>They pre-train the model on ImageNet and then finetune on the Pascal VOC dataset.</li>
<li>Optimize over the sum-squared error</li>
<li>Since most grid cells do not have objects, these gradients overpower the gradients from cells
with objects in them leading to model instability. To account for this, they weigh the
bounding box loss higher than the loss from confidence using 2 parameters Œª<sub>coord</sub> =
5 for bounding boxes and Œª<sub>noobj</sub> = 0.5 for confidence.</li>
<li>Sum-squared error equally weighs errors in large and small boxes. Small deviations in large
bounding boxes would have a small effect than in small bounding boxes, to address this issue
they predict the square root of the width and height resulting in similar losses for both
large and small bounding boxes.</li>
</ul>
<br>
<p align="center">
<img src="images/yolo/loss-func.png" alt="Loss Function">
</p>
<br>
</li>
<li>
<p>Results</p>
<ul>
<li>Struggles with too many small nearby objects, such as flock of birds.</li>
<li>Struggles to generalize bounding box on new unusual aspect ratio images.</li>
<li>YOLO scores a 57.9 mAP compared to 70.4 with the Faster R-CNN on the Pascal VOC 2012 dataset.</li>
<li>Pascal VOC 2012 Leaderboard
<img src="images/yolo/leaderboard.png" alt="Leaderboard"></li>
<li>They achieve 45 FPS (22ms/image), compared to 7 FPS (142ms/image) with Faster R-CNN.</li>
<li>YOLO on a diverse dataset, as you can see it generalizes well on artworks too.
<img src="images/yolo/results.png" alt="Results"></li>
</ul>
</li>
</ul>
<h3 id="related-material"><a class="header" href="#related-material">Related Material</a></h3>
<ul>
<li><a href="https://pjreddie.com/darknet/yolo">pjreddie.com/yolo</a></li>
<li><a href="https://github.com/AlexeyAB/darknet">AlexeyAB/darknet</a></li>
<li><a href="https://github.com/aleju/papers/blob/master/neural-nets/YOLO.md">aleju/papers/YOLO.md</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="deep-residual-learning-for-image-recognition.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="world-models.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="deep-residual-learning-for-image-recognition.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="world-models.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
